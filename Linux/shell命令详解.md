# shell命令详解

-   `-l`等价于`--list`，区别在于，短形式便于手动输入，长形式可读性更好，一般用在脚本中
-   多行输入需要在末尾添加`\`
-   Bash会自动忽略多个空格
-   `;`可以区分多个命令，使得一行可以执行多个命令。注意，使用分号时，第二个命令总是接着第一个命令执行，不管第一个命令执行成功或失败。
-   如果需要输出关键字作为字符，需要`\`进行转义
-   `‘ ’`会将里面的内容全部视作字符串，而不进行扩展
-   `" "`与单引号不同的是，会扩展`$`、\`以及`\`，它们在双引号中都保持特殊含义

## 特殊字符

-   `\a`：响铃
-   `\b`：退格
-   `\n`：换行
-   `\r`：回车
-   `\t`：制表符

这些字符不可被转义所打印，如需打印，需要放在`“ ”`之中

```shell
$ echo a\tb
atb

$ echo -e "a\tb"
a        b
```

## 快捷键

`Ctrl + L`：清除屏幕并将当前行移到页面顶部。

`Ctrl + C`：中止当前正在执行的命令。

`Shift + PageUp`：向上滚动。

`Shift + PageDown`：向下滚动。

`Ctrl + U`：从光标位置删除到行首。

`Ctrl + K`：从光标位置删除到行尾。

`Ctrl + W`：删除光标位置前一个单词。

`Ctrl + D`：关闭 Shell 会话。

`↑`，`↓`：浏览已执行命令的历史记录

## `&&`和`||`

`command1 && command2`：1执行成功时才会执行2

`command1 || command2`：只有1失败才会执行2



## `env`

显示所有的环境变量，也可以使用`printenv`

查看单个环境变量的值，可以使用`printenv`命令或`echo`命令。

```shell
$ printenv PATH
# 或者
$ echo $PATH
```

注意，`printenv`命令后面的变量名，不用加前缀`$`



下面是一些常见的环境变量：

-   `BASHPID`：Bash 进程的进程 ID。
-   `BASHOPTS`：当前 Shell 的参数，可以用`shopt`命令修改。
-   `DISPLAY`：图形环境的显示器名字，通常是`:0`，表示 X Server 的第一个显示器。
-   `EDITOR`：默认的文本编辑器。
-   `HOME`：用户的主目录。
-   `HOST`：当前主机的名称。
-   `IFS`：词与词之间的分隔符，默认为空格。
-   `LANG`：字符集以及语言编码，比如`zh_CN.UTF-8`。
-   `PATH`：由冒号分开的目录列表，当输入可执行程序名后，会搜索这个目录列表。
-   `PS1`：Shell 提示符。
-   `PS2`： 输入多行命令时，次要的 Shell 提示符。
-   `PWD`：当前工作目录。
-   `RANDOM`：返回一个0到32767之间的随机数。
-   `SHELL`：Shell 的名字。
-   `SHELLOPTS`：启动当前 Shell 的`set`命令的参数，参见《set 命令》一章。
-   `TERM`：终端类型名，即终端仿真器所用的协议。
-   `UID`：当前用户的 ID 编号。
-   `USER`：当前用户的用户名。

## `set`

显示自定义变量以及环境变量，以及所有Bash函数

## 创建变量   

用户创建变量的时候，变量名必须遵守下面的规则。

-   字母、数字和下划线字符组成。
-   第一个字符必须是一个字母或一个下划线，不能是数字。
-   不允许出现空格和标点符号。

变量声明的语法如下。

```
variable=value
```

上面命令中，等号左边是变量名，右边是变量。注意，等号两边不能有空格。

如果变量的值包含空格，则必须将值放在引号中。

```
myvar="hello world"
```

Bash 没有数据类型的概念，所有的变量值都是字符串。

## 读取变量

在变量名前加`$`

完整写法其实是`${ }`

如果变量的值本身也是变量，可以使用`${!varname}`的语法，读取最终的值。

```shell
$ myvar=USER
$ echo ${!myvar}
ruanyf
```

上面的例子中，变量`myvar`的值是`USER`，`${!myvar}`的写法将其展开成最终的值

## 删除变量   

`unset`命令用来删除一个变量

```
unset NAME
```

这个命令不是很有用。因为不存在的 Bash 变量一律等于空字符串，所以即使`unset`命令删除了变量，还是可以读取这个变量，值为空字符串

所以，删除一个变量，也可以将这个变量设成空字符串

```
$ foo=''
$ foo=
```

上面两种写法，都是删除了变量`foo`。由于不存在的值默认为空字符串，所以后一种写法可以在等号右边不写任何值

## 输出变量`export`

用户创建的变量仅可用于当前 Shell，子 Shell 默认读取不到父 Shell 定义的变量。为了把变量传递给子 Shell，需要使用`export`命令。这样输出的变量，对于子 Shell 来说就是环境变量

子 Shell 如果修改继承的变量，不会影响父 Shell

## 特殊变量

-   `$?`：`$?`为上一个命令的退出码，用来判断上一个命令是否执行成功

    返回值是`0`，表示上一个命令执行成功；如果不是零，表示上一个命令执行失败

-   `$$`：当前Shell的进程ID

-   `$_`：上一个命令的最后一个参数

-   `$!`：最近一个后台执行的异步命令的进程ID

-   `$0`：为当前 Shell 的名称（在命令行直接执行时）或者脚本名（在脚本中执行时）

-   `$-`：当前 Shell 的启动参数

-   `$#`表示脚本的参数数量

-   `$@`表示脚本的参数值

-   `BASH_SOURCE`：`${BASH_SOURCE[0]}`表示bash脚本的第一个参数（如果第一个参数是bash，表明这是要执行bash脚本，这时`"${BASH_SOURCE[0]}"`自动转换为第二个参数

## 特殊命令

## `type`

用于判断一个命令的来源

```shell
$ type echo
echo is a shell builtin
$ type ls
ls is hashed (/bin/ls)
```

说明`echo`是一个shell命令，`ls`是一个外部程序

### 参数

`-a`：查看一个命令的所有定义

`-t`：返回一个命令的类型，包括：别名（alias）、关键词（keyword）、函数（function）内置命令（builtin）和文件（file）

## echo

输出文本，多行文本需要用`" "`

### 参数

-   `-n`：默认情况下，`echo`会在文本末尾输出回车符，`-n`可以取消回车符号

例：

```shell
$ echo a;echo b
a
b

$ echo -n a;echo b
ab
```

-   `-e`：`-e`参数会解释引号（双引号和单引号）里面的特殊字符（比如换行符`\n`）。如果不使用`-e`参数，即默认情况下，引号会让特殊字符变成普通字符，`echo`不解释它们，原样输出。

```shell
$ echo "Hello\nWorld"
Hello\nWorld

# 双引号的情况
$ echo -e "Hello\nWorld"
Hello
World

# 单引号的情况
$ echo -e 'Hello\nWorld'
Hello
World
```

## `basename`

从路径中获取文件名

### 参数

长选项的强制参数对于短选项也是强制的。

-   `-a, --multiple`
    ⽀持多个⽂件名称参数，将每⼀个参数当做⽂件名对待

-   ``-s, --suffix=SUFFIX`
    移除后缀

-   `-z, --zero`
    以空字符 NULL 分隔输出⽽不是换⾏符

-   `--help`
    显⽰帮助并退出

-   `--version`

    显⽰版本并退出


## `dirname`

从⽂件路径中获取⽂件⽬录，作用与`basename`相反

如果⽂件路径中不包含` /`，那么输出` .` 表⽰当前⽬录。如果⽂件路径最后⼀个字符是 `/`，那么剥离倒数第⼆个`/` 及其后的内容

-   `-z, --zero`：⽤空字符 NUL ⽽不是换⾏符分隔输出
-   `--help`：显⽰帮助并退出
-   `--version`：显⽰版本并退出

